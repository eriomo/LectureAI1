<!DOCTYPE html>
<html>
<head>
    <title>LectureAI</title>
    <style>
        body { font-family: Arial; padding: 40px; }
        button { padding: 10px 20px; }
        .section { margin-top: 30px; }
        h3 { margin-bottom: 5px; }
    </style>
</head>
<body>

<h1>LectureAI</h1>

<input id="topic" placeholder="Enter topic" />
<select id="level">
    <option>Beginner</option>
    <option>Intermediate</option>
    <option>Advanced</option>
</select>

<button onclick="generate()">Generate Lesson</button>

<div id="output"></div>

<script>
async function generate() {

    const topic = document.getElementById("topic").value;
    const level = document.getElementById("level").value;

    const output = document.getElementById("output");
    output.innerHTML = "Generating...";

    try {
        const res = await fetch("/generate", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ topic, level, duration: 60 })
        });

        const data = await res.json();
        console.log("Backend Response:", data);

        if (!data.success || !data.data) {
            output.innerHTML = "<p style='color:red'>Error: " + (data.error || "Unknown error") + "</p>";
            return;
        }

        const lesson = data.data;

        const outline = Array.isArray(lesson.outline) ? lesson.outline : [];
        const activities = Array.isArray(lesson.activities) ? lesson.activities : [];
        const student = lesson.student || {};

        let html = "";

        html += "<div class='section'><h2>Outline</h2>";
        outline.forEach(item => {
            html += "<h3>" + item.title + "</h3>";
            html += "<p>" + item.content + "</p>";
        });
        html += "</div>";

        html += "<div class='section'><h2>Activities</h2>";
        activities.forEach(item => {
            html += "<h3>" + item.title + "</h3>";
            html += "<p>" + item.description + "</p>";
        });
        html += "</div>";

        html += "<div class='section'><h2>Student Section</h2>";
        html += "<p>" + (student.micro_explanation || "") + "</p>";

        if (Array.isArray(student.practice_questions)) {
            student.practice_questions.forEach(q => {
                html += "<p>â€¢ " + q + "</p>";
            });
        }

        html += "</div>";

        output.innerHTML = html;

    } catch (err) {
        output.innerHTML = "<p style='color:red'>Frontend Error: " + err.message + "</p>";
    }
}
</script>

</body>
</html>
